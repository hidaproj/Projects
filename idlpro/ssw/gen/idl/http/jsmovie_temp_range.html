<HTML>

<HEAD>
<TITLE> Javascript Movie Player </TITLE>

</HEAD>

<BODY FONT=3 BGCOLOR=FFFFFF LINK=#0000CC VLINK=#0000CC TEXT=#000000> 

<SCRIPT language="Javascript">
<!--
//
// DYNAMICALLY CREATED HTML - DO NOT EDIT
//
// Javascript program to produce fast animations by reading from cache
// Written: 7 July 1997, Zarro, NASA/GSFC
// Modified: 27 July 1997, Freeland, LSAL - added nice SWING option
// Modified: 9 Oct 1998, Zarro, SMA/GSFC - added context window button
// Modified: 14 Oct 1998, Zarro, SMA/GSFC - load images asynchronously
// Modified: 20 May 1999, Freeland, LMSAL - add subrange buttons and function
// Modified: 23 Aug 1999, William Thompson, GSFC - make button text black

// Following variables control movie speed, labels, etc.

var imax = 12, inc = 1.50, delay = 250;
var num_loaded_images = 0;
var frame=-1, speed=24;
var timeout_id=null;
var dir=1, playing=0, swingon=0, run=0;
var bname = "Reverse";
var url_path = ".";
var context = "frame00.gif";
var ctitle ="test";
var url_context=url_path+"/"+context;
var iwidth=null, iheight=null;
var index=0;

// -->
</SCRIPT>

<CENTER>

<H1> Javascript Movie Player </H1>
<P>

<TABLE BORDER="10" CELLPADDING="8">
<TR>
<TD align="center"> 
<img src = "./frame00.gif" NAME=animation ALT="FRAME" width=512 height=512>
</TR>
</TABLE>
<P>

<FORM NAME="form">
 <FONT COLOR="Black">
 <INPUT TYPE=button VALUE="Start" onClick="start_play();">
 <INPUT TYPE=button VALUE="Pause" onClick="stop_play();">
 <INPUT TYPE=button VALUE="Faster" onClick="speed*=inc; show_speed();">
 <INPUT TYPE=button VALUE="Slower" onClick="speed/=inc; show_speed();">
 <INPUT TYPE=button VALUE="Step" onClick="step();">
 <INPUT TYPE=button NAME="direction" VALUE="Reverse" onClick="reverse();">
 <INPUT TYPE=button VALUE="Swing Mode:" onClick="swing_mode();">
 <INPUT TYPE=text VALUE="OFF" NAME="swing" SIZE=3>
 <INPUT TYPE=button VALUE="Context" onClick="pop_img(url_context,ctitle, 600,700);">
 </FONT>
 <BR>
 Frame: <INPUT TYPE=text VALUE="" NAME="frame" SIZE=22> 
 &nbsp; Speed:<INPUT TYPE=text VALUE="" NAME="rate" SIZE=4> (frames/sec)

 <BR>
 <INPUT TYPE=button NAME="set_start" VALUE="Current->Start"  onClick="cur2start();" >
     Range Start: <INPUT TYPE=text VALUE="0" NAME="start_frame" SIZE=3>
 <INPUT TYPE=button NAME="set_start" VALUE="Current->Stop"  onClick="cur2stop();">
     Range Stop: <INPUT TYPE=text VALUE="0" NAME="stop_frame" SIZE=3>
 <INPUT TYPE=button NAME="clearrange" VALUE="Clear Range" onClick="clear_range();">

</FORM>
 
</FORM>
</CENTER>

<P>
<HR>
<B>Document</B>: <I><SCRIPT>document.write(document.title);</SCRIPT></I><BR>
<B>URL</B>: <I><SCRIPT>document.write(document.URL);</SCRIPT></I><BR>
<B>Last Update</B>: <I><SCRIPT>document.write(document.lastModified);</SCRIPT></I><BR>


<SCRIPT LANGUAGE="JavaScript">
<!--

function get_window_width(fac,def) {  // Return window width

 
var width;
if (!fac) {fac=.75;}
if (!def) {def=512;}

if (window.screen) {
 width=parseInt(fac*parseFloat(window.screen.width));
} else {
 width=def;
}

return width;

}

/////////////////////////////////////////////////////////////////////////////

function get_window_height(fac,def) {   // Return window height

 
var height;
if (!fac) {fac=.75;}
if (!def) {def=512;}

if (window.screen) {
 height=parseInt(fac*parseFloat(window.screen.height));
} else {
 height=def;
}

return height;

}

/////////////////////////////////////////////////////////////////////////////
// Javascript Pop-up image Window
// Written: Zarro (SAC/GSFC), October 1998, (dzarro@solar.stanford.edu)

var win;

function pop_img(url,title,width,height) {

if (!url) {
 alert('Image URL not entered');
 return false;
}

// default to fit within 75% of browser window, or 512x512

if (!width) {width=get_window_width(.75,512);}
if (!height) {height=get_window_height(.75,512);}

if (!win || win.closed) {
 win = open("","img","width="+width.toString()+",height="+height.toString()+",scrollbars=yes,resizable=yes"); 
}

// dynamically create HTML, adding a CLOSE button

if (win) {
 d=win.document;
 d.write('<html><head><title>Image Window</title></head><body bgcolor="white"><center>');
 if (title) {
  d.write('<h1>'+title+'</h1>');
 }
 d.write('<img src='+url+'>');
 d.write('<br><br><br>');
 d.write('<form><b><input type="button" value="CLOSE" onClick="self.close();"></b></form></center>'); 
 d.write('</html></body>');
 d.close();
 win.focus();
}

return true;     
}

///////////////////////////////////////////////////////////////////////////

function load_img() {        // asynchronously load all images into cache
 for (i=0; i < imax ; i++) {
  id[i]=setTimeout("load_src()",0);
 }
 return;
}
/////////////////////////////////////////////////////////////////////////////

function load_src() {      // load individual images into cache

 if (index < imax) {
  if (iwidth && iheight) {
   images[index] = new Image(iwidth,iheight);
  } else {
   images[index] = new Image();
  }
  images[index].onload=count_images;
  images[index].src = urls[index];
  index++;
 }
 return;
}

/////////////////////////////////////////////////////////////////////////////

function clear_ids() {         // clear asynchronous id's
 for (i=0; i < imax ; i++) {clearTimeout(id[i]);}
 return;
}


/////////////////////////////////////////////////////////////////////////////

function count_images() // count images as they are loaded into cache
{ 
 if (++num_loaded_images == imax) {
  show_speed();
  clear_ids();
  animate();
 } else {
  document.animation.src=images[num_loaded_images-1].src;
  document.form.frame.value="Loading "+num_loaded_images+" of "+imax; 
 }
}

///////////////////////////////////////////////////////////////////////////

function reset_display()      // update display/settings after range change
{
  var j;
  frame=rstart;
  j=frame+1;
  if (images[frame].complete) {
    document.animation.src=images[frame].src;
    document.form.frame.value="Displaying "+j+" of "+imax;
  }
  playing=0;
}  
		    
///////////////////////////////////////////////////////////////////////////

function clear_range() // clear subrange
{
  rstart=0;
  frame=-1;
  rstop=imax-1;
  dir=1;
  playing=0;
  document.form.start_frame.value=rstart+1;
  document.form.stop_frame.value=rstop+1;
  document.form.direction.value="Reverse"; bname="Reverse";
  reset_display();
}

///////////////////////////////////////////////////////////////////////////
   
function cur2start() // set current frame to start range
{
  playing=0;
  dir=1;
  rstart=frame;
  document.form.start_frame.value=rstart+1;
  if (rstart >= rstop) {
     rstop=imax-1;
     document.form.stop_frame.value=rstop+1;
  }
  document.form.direction.value="Reverse"; bname="Reverse";
}
				     
///////////////////////////////////////////////////////////////////////////

function cur2stop() // set current frame to stop range
{
  playing=0;
  dir=-1
  rstop=frame;
  document.form.stop_frame.value=rstop+1;
  if (rstart >= rstop) {
     rstart=0;
     document.form.start_frame.value=rstart+1;
  } 
  document.form.direction.value="Forward"; bname="Forward";
}

function image_abort() //  abort loading images
{ 
 imax=num_loaded_images;
 if (!images[num_loaded_images].complete) imax=imax-1;
 alert("Aborting");
 if (imax > -1) animate(); 
}

///////////////////////////////////////////////////////////////////////////

function image_error(message) //  abort loading images
{ 
 alert(message);
}

///////////////////////////////////////////////////////////////////////////

function start_play()  // start movie
{
 if (playing == 0) {
  if (timeout_id == null && num_loaded_images==imax) animate();
 }
} 

///////////////////////////////////////////////////////////////////////////

function stop_play() // stop movie
{ 
 if (timeout_id) clearTimeout(timeout_id); 
  timeout_id=null;
  playing = 0;
} 

///////////////////////////////////////////////////////////////////////////

function swing_mode()    // set swing mode
{
 if (swingon) {
  swingon=0;
  document.form.swing.value="OFF";
 }
  else {
  swingon=1;
  document.form.swing.value="ON";
 }
}


///////////////////////////////////////////////////////////////////////////

function next_frame()   // increment frame logic (TODO - work through equivilent  "mod" logic....
{
  frame=frame+dir;
  if (frame < rstart) {
    frame=rstop;
    if (swingon) frame=rstart;
    } else 
    {
      if (frame > rstop) {
        frame=rstart;
        if (swingon) frame=rstop;
        }
    }
}

///////////////////////////////////////////////////////////////////////////
  
function animate()  // control movie loop
{
 var j;
 next_frame();
 j=frame+1;
 if (images[frame].complete) {
   document.animation.src=images[frame].src;
   document.form.frame.value="Displaying "+j+" of "+imax;
   if (swingon && (j == (rstop+1) || frame == rstart)) reverse();
   timeout_id=setTimeout("animate()",delay);
   playing=1;
 }
}

///////////////////////////////////////////////////////////////////////////

function step() // step frames
{
 var j;
 if (timeout_id) clearTimeout(timeout_id); timeout_id=null;
 next_frame();
 j=frame+1;
 if (images[frame].complete) {
    document.animation.src=images[frame].src;
    document.form.frame.value="Displaying "+j+" of "+imax;
    if (swingon && (j == (rstop+1) || frame == rstart)) reverse();
    playing=0;
 }
}

///////////////////////////////////////////////////////////////////////////

function reverse()  // reverse direction
{
 dir=-dir;
 if (dir > 0) document.form.direction.value="Reverse"; bname="Reverse";
 if (dir < 0) document.form.direction.value="Forward"; bname="Forward";
}

///////////////////////////////////////////////////////////////////////////

function show_speed()      // show speed
{
  document.form.rate.value=Math.round(speed);
  delay = 1000.0/speed; 
}

///////////////////////////////////////////////////////////////////////////
// actual image loading is done here

show_speed();
images = new Array(imax);          
urls= new Array(imax);
id= new Array(imax);

urls[0]=url_path+"/frame00.gif";

load_img();

// -->
</SCRIPT>

</BODY>
</HTML>

